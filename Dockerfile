FROM golang:1.18-buster AS builder

WORKDIR $GOPATH/src/github.com/radurobot/race-condition-exploit

COPY . .
RUN go get -d -v
RUN go build -o /go/bin/race-condition-exploit

# Smallish image for actual running
FROM gcr.io/distroless/base-debian10

COPY --from=builder /go/bin/race-condition-exploit /go/bin/race-condition-exploit

ENTRYPOINT ["/go/bin/race-condition-exploit"]

